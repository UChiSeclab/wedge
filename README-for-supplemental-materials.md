# WEDGE: An Efficient Framework for Performance-Stressing Test Generation

WEDGE is a framework for generating performance-stressing inputs given a program-under-test. WEDGE synthesizes explicit performance-characterizing constraints in the form of branch conditions to partition the programs’ execution space into9
performance-specific regions with the help of language models. WEDGE is integareted with a coverage-guided fuzzer based on AFL++ to generate tests regions introduces explicit rewards for test generation to explore inefficient implementations. 

This repository contains the tests generated by WEDGE collected into a new benchmark called PerfForge. We hope PerfForge can serve evaluate future (AI-driven) approaches for efficient code-generation.

## Getting Started

The repository has the following directory structure. Users are recommended not to alter this structure unless they also modify the tooling in `./code`.

```
wedge
├──problems
|  ├── problemA
|  |   ├── metadata
|  |   |   ├── problem_statement.txt
|  |   |   ├── llm_prompt_constraints.txt
|  |   |   ├── llm_response_constraints.txt
|  |   ├── measurements
|  |   |   ├── problemA_stats.JSON
|  |   ├── solutions
|  |   |   ├── sol1.cpp
|  |   |   ├── sol2.cpp
|  |   |    ...
|  |   └── tests
|  |       ├── codecontests
|  |       ├── wedge
|  |       ├── evalperf-rand
|  |       ├── evalperf-slow
|  |       └── tgprompt
|  ├── problemB
|  |   ├── ...  
 ...
|
├── code
|  ├── get_stats.py
|  ├── gpt_constraints.prompt
|  └── run.py
├── README
└── LICENSE
```

#### Cloning the repository

To download the repository locally, users can run the following command:
```
git clone https://github.com/elmerjfudd/wedge
```
We encourate users to check that the downloaded copy has the same directory structure as above.

#### Environment Setup

WEDGE relies on a few dependencies:
- Ubuntu 20.04 or later
- Python 3.8 or later, along with several relevant packages
- `perf` X.XX or later
- `gcov` X.XX or later

To install these dependencies, users can run the following command:
```
sudo ./setup_env.sh
```
Note that some of the utilities (e.g. `perf`) require root user privileges.

Finally, users need to update their `PYTHONPATH` environment varialbe:
```
export PYTHONPATH=$PYTHONPATH:$(pwd)/code
```

## Collecting statistics over our raw data

We provide users with the raw measurements collected by WEDGE. This way, users can collect statistics and recreate the tables and figures for our main experiements: WEDGE vs. baslines; and WEDGE vs. its ablated versions.



The source code can be found at `./code/get-stats`

## Re-run our main experiments

