/* line 1 */ import java.awt.List;
/* line 2 */ import java.io.BufferedWriter;
/* line 3 */ import java.io.IOException;
/* line 4 */ import java.io.InputStream;
/* line 5 */ import java.io.OutputStreamWriter;
/* line 6 */ import java.util.ArrayList;
/* line 7 */ import java.util.Arrays;
/* line 8 */ import java.util.Collections;
/* line 9 */ import java.util.HashMap;
/* line 10 */ import java.util.HashSet;
/* line 11 */ import java.util.Iterator;
/* line 12 */ import java.util.Map.Entry;
/* line 13 */ import java.util.PriorityQueue;
/* line 14 */ import java.util.Random;
/* line 15 */ import java.util.TreeSet;
/* line 16 */ 
/* line 17 */ 
/* line 18 NOT_COVERED */ public final class CF_TechCup2018_R3_E_v2 {
/* line 19 */ 
/* line 20 COVERED, hit count: 1 */ 	static boolean verb=true;
/* line 21 NOT_COVERED */ 	static void log(Object X){if (verb) System.err.println(X);}
/* line 22 NOT_COVERED */ 	static void log(Object[] X){if (verb) {for (Object U:X) System.err.print(U+" ");System.err.println("");}}
/* line 23 NOT_COVERED */ 	static void log(int[] X){if (verb) {for (int U:X) System.err.print(U+" ");System.err.println("");}}
/* line 24 NOT_COVERED */ 	static void log(int[] X,int L){if (verb) {for (int i=0;i<L;i++) System.err.print(X[i]+" ");System.err.println("");}}
/* line 25 NOT_COVERED */ 	static void log(long[] X){if (verb) {for (long U:X) System.err.print(U+" ");System.err.println("");}}
/* line 26 */ 
/* line 27 NOT_COVERED */ 	static void logWln(Object X){if (verb) System.err.print(X);}
/* line 28 NOT_COVERED */ 	static void info(Object o){	System.out.println(o);}
/* line 29 COVERED, hit count: 1 */ 	static void output(Object o){outputWln(""+o+"\n");	}
/* line 30 COVERED, hit count: 1 */ 	static void outputWln(Object o){try {out.write(""+ o);} catch (Exception e) {}}
/* line 31 */ 
/* line 32 */ 
/* line 33 */ 
/* line 34 */ 	// Global vars
/* line 35 */ 	static BufferedWriter out;
/* line 36 */ 	static InputReader reader;
/* line 37 */ 
/* line 38 */ 
/* line 39 COVERED, hit count: 1 */ 	static long mod=1000000007;
/* line 40 */ 
/* line 41 */ 
/* line 42 COVERED, hit count: 1 */ 	static int BIG=1001;
/* line 43 */ 
/* line 44 COVERED, hit count: 1 */ 	static int FORBID=-1;
/* line 45 COVERED, hit count: 1 */ 	static int OK=1;
/* line 46 */ 
/* line 47 */ 
/* line 48 */ 	static void process() throws Exception {
/* line 49 */ 
/* line 50 */ 
/* line 51 COVERED, hit count: 1 */ 		out = new BufferedWriter(new OutputStreamWriter(System.out));
/* line 52 COVERED, hit count: 1 */ 		reader=new InputReader(System.in);
/* line 53 */ 
/* line 54 */ 
/* line 55 */ 
/* line 56 COVERED, hit count: 1 */ 		int n=reader.readInt();
/* line 57 */ 
/* line 58 COVERED, hit count: 1 */ 		int[] a=new int[n];
/* line 59 */ 
/* line 60 COVERED, hit count: 1 */ 		int MX=101;
/* line 61 COVERED, hit count: 1 */ 		int[] cnt=new int[MX];
/* line 62 COVERED, hit count: 1 */ 		int MAX=0;
/* line 63 COVERED, hit count: 1 */ 		HashSet<Integer> all=new HashSet<Integer>();
/* line 64 PARTIALLY_COVERED, hit count: 101 */ 		for (int i=0;i<n;i++){
/* line 65 COVERED, hit count: 100 */ 			a[i]=reader.readInt();
/* line 66 COVERED, hit count: 100 */ 			cnt[a[i]]++;
/* line 67 COVERED, hit count: 100 */ 			MAX+=a[i];
/* line 68 COVERED, hit count: 100 */ 			all.add(a[i]);
/* line 69 */ 
/* line 70 */ 		}
/* line 71 */ 
/* line 72 COVERED, hit count: 1 */ 		MAX++;
/* line 73 COVERED, hit count: 1 */ 		int best=0;
/* line 74 COVERED, hit count: 1 */ 		if (all.size()<=2){
/* line 75 NOT_COVERED */ 			best=n; 
/* line 76 */ 		} else {
/* line 77 COVERED, hit count: 1 */ 			int top=0;
/* line 78 COVERED, hit count: 1 */ 			int[][] mem=new int[MAX][n+1];
/* line 79 COVERED, hit count: 1 */ 			mem[0][0]=1;
/* line 80 COVERED, hit count: 1 */ 			int[] mx=new int[MAX];
/* line 81 PARTIALLY_COVERED, hit count: 102 */ 			for (int u=0;u<MX;u++){
/* line 82 PARTIALLY_COVERED, hit count: 101 */ 				if (cnt[u]>0){
/* line 83 COVERED, hit count: 22 */ 					top+=cnt[u]*u;
/* line 84 PARTIALLY_COVERED, hit count: 72933 */ 					for (int w=top;w>=0;w--){
/* line 85 */ 					
/* line 86 */ 						
/* line 87 PARTIALLY_COVERED, hit count: 2517483 */ 						for (int j=mx[w];j>=0;j--){
/* line 88 PARTIALLY_COVERED, hit count: 2444572 */ 							if (mem[w][j]!=0){
/* line 89 */ 						
/* line 90 PARTIALLY_COVERED, hit count: 3819635 */ 								for (int k=cnt[u];k>0;k--){
/* line 91 COVERED, hit count: 3140171 */ 									int x=w+k*u;
/* line 92 COVERED, hit count: 3140171 */ 									mx[x]=Math.max(mx[x],mx[w]+k);
/* line 93 PARTIALLY_COVERED, hit count: 3140171 */ 									if (mem[w][j]==FORBID){
/* line 94 COVERED, hit count: 3112666 */ 										mem[x][j+k]=FORBID;
/* line 95 */ 									} else {
/* line 96 PARTIALLY_COVERED, hit count: 27505 */ 										if (mem[x][j+k]==0)
/* line 97 COVERED, hit count: 12737 */ 											mem[x][j+k]=OK;
/* line 98 */ 										else
/* line 99 COVERED, hit count: 14768 */ 											mem[x][j+k]=FORBID;
/* line 100 */ 									}
/* line 101 */ 								}								
/* line 102 */ 							}
/* line 103 */ 						}
/* line 104 */ 					}
/* line 105 */ 				}
/* line 106 */ 
/* line 107 */ 			}
/* line 108 PARTIALLY_COVERED, hit count: 102 */ 			for (int u=0;u<MX;u++){
/* line 109 PARTIALLY_COVERED, hit count: 101 */ 				if (cnt[u]>0){
/* line 110 PARTIALLY_COVERED, hit count: 122 */ 					for (int j=1;j<=cnt[u];j++){
/* line 111 PARTIALLY_COVERED, hit count: 100 */ 						if (mem[u*j][j]==OK){
/* line 112 COVERED, hit count: 36 */ 							best=Math.max(best, j);
/* line 113 */ 						}
/* line 114 */ 					}
/* line 115 */ 				}
/* line 116 */ 			}
/* line 117 */ 
/* line 118 */ 		}
/* line 119 COVERED, hit count: 1 */ 		output(best);
/* line 120 */ 
/* line 121 */ 		try {
/* line 122 COVERED, hit count: 1 */ 			out.close();
/* line 123 */ 		}
/* line 124 COVERED, hit count: 1 */ 		catch (Exception EX){}
/* line 125 */ 
/* line 126 */ 
/* line 127 COVERED, hit count: 1 */ 	}
/* line 128 */ 
/* line 129 */ 
/* line 130 */ 	public static void main(String[] args) throws Exception {
/* line 131 COVERED, hit count: 1 */ 		process();
/* line 132 */ 
/* line 133 COVERED, hit count: 1 */ 	}
/* line 134 */ 
/* line 135 */ 	static final class InputReader {
/* line 136 */ 		private final InputStream stream;
/* line 137 COVERED, hit count: 1 */ 		private final byte[] buf = new byte[1024];
/* line 138 */ 		private int curChar;
/* line 139 */ 		private int numChars;
/* line 140 */ 
/* line 141 COVERED, hit count: 1 */ 		public InputReader(InputStream stream) {
/* line 142 COVERED, hit count: 1 */ 			this.stream = stream;
/* line 143 COVERED, hit count: 1 */ 		}
/* line 144 */ 
/* line 145 */ 		private int read() throws IOException {
/* line 146 PARTIALLY_COVERED, hit count: 304 */ 			if (curChar >= numChars) {
/* line 147 COVERED, hit count: 1 */ 				curChar = 0;
/* line 148 COVERED, hit count: 1 */ 				numChars = stream.read(buf);
/* line 149 COVERED, hit count: 1 */ 				if (numChars <= 0) {
/* line 150 NOT_COVERED */ 					return -1;
/* line 151 */ 				}
/* line 152 */ 			}
/* line 153 COVERED, hit count: 304 */ 			return buf[curChar++];
/* line 154 */ 		}
/* line 155 */ 
/* line 156 */ 
/* line 157 */ 		public final String readString() throws IOException {
/* line 158 NOT_COVERED */ 			int c = read();
/* line 159 NOT_COVERED */ 			while (isSpaceChar(c)) {
/* line 160 NOT_COVERED */ 				c = read();
/* line 161 */ 			}
/* line 162 NOT_COVERED */ 			StringBuilder res=new StringBuilder();
/* line 163 */ 			do {
/* line 164 NOT_COVERED */ 				res.append((char)c);
/* line 165 NOT_COVERED */ 				c = read();
/* line 166 NOT_COVERED */ 			} while (!isSpaceChar(c));
/* line 167 NOT_COVERED */ 			return res.toString();
/* line 168 */ 		}
/* line 169 */ 
/* line 170 */ 		public final int readInt() throws IOException {
/* line 171 COVERED, hit count: 101 */ 			int c = read();
/* line 172 COVERED, hit count: 101 */ 			boolean neg=false;
/* line 173 COVERED, hit count: 101 */ 			while (isSpaceChar(c)) {
/* line 174 NOT_COVERED */ 				c = read();
/* line 175 */ 			}
/* line 176 COVERED, hit count: 101 */ 			char d=(char)c;
/* line 177 */ 			//log("d:"+d);
/* line 178 COVERED, hit count: 101 */ 			if (d=='-') {
/* line 179 NOT_COVERED */ 				neg=true;
/* line 180 NOT_COVERED */ 				c = read();
/* line 181 */ 			}
/* line 182 COVERED, hit count: 101 */ 			int res = 0;
/* line 183 */ 			do {
/* line 184 COVERED, hit count: 203 */ 				res *= 10;
/* line 185 COVERED, hit count: 203 */ 				res += c - '0';
/* line 186 COVERED, hit count: 203 */ 				c = read();
/* line 187 PARTIALLY_COVERED, hit count: 203 */ 			} while (!isSpaceChar(c));
/* line 188 */ 			//log("res:"+res);
/* line 189 COVERED, hit count: 101 */ 			if (neg)
/* line 190 NOT_COVERED */ 				return -res;
/* line 191 COVERED, hit count: 101 */ 			return res;
/* line 192 */ 
/* line 193 */ 		}
/* line 194 */ 
/* line 195 */ 		public final long readLong() throws IOException {
/* line 196 NOT_COVERED */ 			int c = read();
/* line 197 NOT_COVERED */ 			boolean neg=false;
/* line 198 NOT_COVERED */ 			while (isSpaceChar(c)) {
/* line 199 NOT_COVERED */ 				c = read();
/* line 200 */ 			}
/* line 201 NOT_COVERED */ 			char d=(char)c;
/* line 202 */ 			//log("d:"+d);
/* line 203 NOT_COVERED */ 			if (d=='-') {
/* line 204 NOT_COVERED */ 				neg=true;
/* line 205 NOT_COVERED */ 				c = read();
/* line 206 */ 			}
/* line 207 NOT_COVERED */ 			long res = 0;
/* line 208 */ 			do {
/* line 209 NOT_COVERED */ 				res *= 10;
/* line 210 NOT_COVERED */ 				res += c - '0';
/* line 211 NOT_COVERED */ 				c = read();
/* line 212 NOT_COVERED */ 			} while (!isSpaceChar(c));
/* line 213 */ 			//log("res:"+res);
/* line 214 NOT_COVERED */ 			if (neg)
/* line 215 NOT_COVERED */ 				return -res;
/* line 216 NOT_COVERED */ 			return res;
/* line 217 */ 
/* line 218 */ 		}
/* line 219 */ 
/* line 220 */ 
/* line 221 */ 
/* line 222 */ 
/* line 223 */ 		private boolean isSpaceChar(int c) {
/* line 224 PARTIALLY_COVERED, hit count: 304 */ 			return c == ' ' || c == '\n' || c == '\r' || c == '\t' || c == -1;
/* line 225 */ 		}
/* line 226 */ 	}
/* line 227 */ 
/* line 228 */ 
/* line 229 */ }