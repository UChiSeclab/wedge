/* line 1 */ import java.io.*;
/* line 2 */ import java.util.*;
/* line 3 */ 
/* line 4 NOT_COVERED */ public class Solution {
/* line 5 */ 
/* line 6 */ 
/* line 7 */     static MyScanner sc;
/* line 8 */     private static PrintWriter out;
/* line 9 COVERED, hit count: 1 */     static long M2 = 1_000_000_000L + 7;
/* line 10 */ 
/* line 11 */     public static void main(String[] s) throws Exception {
/* line 12 COVERED, hit count: 1 */         StringBuilder stringBuilder = new StringBuilder();
/* line 13 */ //        for (int p = 0; p < 100; p++) {
/* line 14 */ //            stringBuilder.append(" 30 " + p * 5 + " 0 ");
/* line 15 */ //        }
/* line 16 */ //  3 3 2 2 3 3 3 2 2 3
/* line 17 */ 
/* line 18 COVERED, hit count: 1 */         if (stringBuilder.length() == 0) {
/* line 19 COVERED, hit count: 1 */             sc = new MyScanner(System.in);
/* line 20 */         } else {
/* line 21 NOT_COVERED */             sc = new MyScanner(new BufferedReader(new StringReader(stringBuilder.toString())));
/* line 22 */         }
/* line 23 */ 
/* line 24 COVERED, hit count: 1 */         out = new PrintWriter(new OutputStreamWriter(System.out));
/* line 25 */ 
/* line 26 COVERED, hit count: 1 */         initData();
/* line 27 COVERED, hit count: 1 */         solve();
/* line 28 COVERED, hit count: 1 */         out.flush();
/* line 29 COVERED, hit count: 1 */     }
/* line 30 */ 
/* line 31 */     private static void initData() {
/* line 32 */ 
/* line 33 COVERED, hit count: 1 */     }
/* line 34 */ 
/* line 35 */ 
/* line 36 */     private static void solve() throws IOException {
/* line 37 COVERED, hit count: 1 */         int n = sc.nextInt();
/* line 38 COVERED, hit count: 1 */         int k = sc.nextInt();
/* line 39 COVERED, hit count: 1 */         int[] max = new int[n];
/* line 40 COVERED, hit count: 1 */         int[] min = new int[n];
/* line 41 COVERED, hit count: 1 */         Arrays.fill(max, n - 1);
/* line 42 COVERED, hit count: 1 */         Arrays.fill(min, 0);
/* line 43 PARTIALLY_COVERED, hit count: 8 */         for (int t = 0; t < k; t++) {
/* line 44 COVERED, hit count: 7 */             int tt = sc.nextInt();
/* line 45 COVERED, hit count: 7 */             int l = sc.nextInt() - 1;
/* line 46 COVERED, hit count: 7 */             int r = sc.nextInt() - 1;
/* line 47 COVERED, hit count: 7 */             int v = sc.nextInt() - 1;
/* line 48 PARTIALLY_COVERED, hit count: 7 */             if (tt == 1) {
/* line 49 PARTIALLY_COVERED, hit count: 63 */                 for (int i = l; i <= r; i++) {
/* line 50 COVERED, hit count: 59 */                     min[i] = Math.max(min[i], v);
/* line 51 */                 }
/* line 52 */             } else {
/* line 53 PARTIALLY_COVERED, hit count: 68 */                 for (int i = l; i <= r; i++) {
/* line 54 COVERED, hit count: 65 */                     max[i] = Math.min(max[i], v);
/* line 55 */                 }
/* line 56 */             }
/* line 57 */         }
/* line 58 */ 
/* line 59 COVERED, hit count: 20 */         for (int tt = 0; tt < n; tt++) {
/* line 60 PARTIALLY_COVERED, hit count: 20 */             if (min[tt] > max[tt]) {
/* line 61 COVERED, hit count: 1 */                 out.println(-1);
/* line 62 COVERED, hit count: 1 */                 return;
/* line 63 */             }
/* line 64 */         }
/* line 65 */ 
/* line 66 NOT_COVERED */         long[][] a = new long[n][n * n];
/* line 67 */ 
/* line 68 NOT_COVERED */         for (long[] t : a) {
/* line 69 NOT_COVERED */             Arrays.fill(t, Long.MAX_VALUE);
/* line 70 */         }
/* line 71 */ 
/* line 72 NOT_COVERED */         for (int i = 0; i < n; i++) {
/* line 73 NOT_COVERED */             for (int r = 0; r < n; r++) {
/* line 74 NOT_COVERED */                 for (int l = min[i]; l <= max[i]; l++) {
/* line 75 NOT_COVERED */                     a[i][l * n + r] = r * 2 + 1;
/* line 76 */                 }
/* line 77 */             }
/* line 78 */         }
/* line 79 */ 
/* line 80 NOT_COVERED */         out.println(hungarian(a));
/* line 81 NOT_COVERED */     }
/* line 82 */ 
/* line 83 */ 
/* line 84 */     static long hungarian(long[][] data) {
/* line 85 NOT_COVERED */         if (data.length == 0) return 0;
/* line 86 NOT_COVERED */         int h = data.length, n = data[0].length;
/* line 87 NOT_COVERED */         if (h > n) return Long.MAX_VALUE;
/* line 88 */ 
/* line 89 NOT_COVERED */         long[] labelx = new long[h], labely = new long[n];
/* line 90 */         // s and t - as per algorithm
/* line 91 NOT_COVERED */         int[] x = new int[h], y = new int[n], t = new int[n], s = new int[h + 1];
/* line 92 NOT_COVERED */         Arrays.fill(x, -1);
/* line 93 NOT_COVERED */         Arrays.fill(y, -1);
/* line 94 */ 
/* line 95 NOT_COVERED */         for (int i = 0; i < h; ) {
/* line 96 NOT_COVERED */             Arrays.fill(t, -1);
/* line 97 NOT_COVERED */             s[0] = i;
/* line 98 NOT_COVERED */             int q = 0;
/* line 99 NOT_COVERED */             boolean br = false;
/* line 100 */             found:
/* line 101 NOT_COVERED */             for (int p = 0; p <= q; ++p) {
/* line 102 NOT_COVERED */                 for (int k = s[p], j = 0; j < n; ++j) {
/* line 103 NOT_COVERED */                     if (labelx[k] + labely[j] == data[k][j] && t[j] < 0) {
/* line 104 NOT_COVERED */                         s[++q] = y[j];
/* line 105 NOT_COVERED */                         t[j] = k;
/* line 106 NOT_COVERED */                         if (s[q] < 0) {
/* line 107 NOT_COVERED */                             for (p = j; p >= 0; j = p) {
/* line 108 NOT_COVERED */                                 y[j] = k = t[j];
/* line 109 NOT_COVERED */                                 p = x[k];
/* line 110 NOT_COVERED */                                 x[k] = j;
/* line 111 */                             }
/* line 112 NOT_COVERED */                             i++;
/* line 113 NOT_COVERED */                             br = true;
/* line 114 NOT_COVERED */                             break found;
/* line 115 */                         }
/* line 116 */                     }
/* line 117 */                 }
/* line 118 */             }
/* line 119 NOT_COVERED */             if (br) continue;
/* line 120 NOT_COVERED */             long delta = Long.MAX_VALUE;
/* line 121 */             // improve labelling
/* line 122 NOT_COVERED */             for (int j = 0; j < n; j++)
/* line 123 NOT_COVERED */                 if (t[j] < 0) {
/* line 124 NOT_COVERED */                     for (int k = 0; k <= q; ++k)
/* line 125 NOT_COVERED */                         if (data[s[k]][j] != Long.MAX_VALUE)
/* line 126 NOT_COVERED */                             delta = Math.min(delta, data[s[k]][j] - labelx[s[k]] - labely[j]);
/* line 127 */                 }
/* line 128 NOT_COVERED */             if (delta == Long.MAX_VALUE)
/* line 129 NOT_COVERED */                 return Long.MAX_VALUE;
/* line 130 NOT_COVERED */             for (int j = 0; j < n; ++j) {
/* line 131 NOT_COVERED */                 if (t[j] >= 0)
/* line 132 NOT_COVERED */                     labely[j] -= delta;
/* line 133 */             }
/* line 134 NOT_COVERED */             for (int k = 0; k <= q; ++k)
/* line 135 NOT_COVERED */                 labelx[s[k]] += delta;
/* line 136 */ 
/* line 137 NOT_COVERED */         }
/* line 138 NOT_COVERED */         long res = 0;
/* line 139 NOT_COVERED */         for (int i = 0; i < h; ++i)
/* line 140 NOT_COVERED */             res += data[i][x[i]];
/* line 141 NOT_COVERED */         return res;
/* line 142 */     }
/* line 143 */ 
/* line 144 */ 
/* line 145 */     private static long m(int n) {
/* line 146 NOT_COVERED */         return 1L * n * n;
/* line 147 */     }
/* line 148 */ 
/* line 149 */ 
/* line 150 */     private static boolean isset(long i, int k) {
/* line 151 NOT_COVERED */         return (i & (1 << k)) > 0;
/* line 152 */     }
/* line 153 */ 
/* line 154 */     private static long c(long from, long to) {
/* line 155 NOT_COVERED */         long res = (fact(to) * inv(from)) % M2;
/* line 156 NOT_COVERED */         return (res * inv(to - from)) % M2;
/* line 157 */     }
/* line 158 */ 
/* line 159 */     private static long inv(long from) {
/* line 160 NOT_COVERED */         return pow(fact(from), M2 - 2, M2);
/* line 161 */     }
/* line 162 */ 
/* line 163 */     private static long fact(long from) {
/* line 164 NOT_COVERED */         long r = 1;
/* line 165 NOT_COVERED */         for (int i = 1; i <= from; i++) {
/* line 166 NOT_COVERED */             r *= i;
/* line 167 NOT_COVERED */             r %= M2;
/* line 168 */ 
/* line 169 */         }
/* line 170 NOT_COVERED */         return r;
/* line 171 */     }
/* line 172 */ 
/* line 173 */     private static void solveT() throws IOException {
/* line 174 NOT_COVERED */         int t = sc.nextInt();
/* line 175 NOT_COVERED */         while (t-- > 0) {
/* line 176 NOT_COVERED */             solve();
/* line 177 */         }
/* line 178 NOT_COVERED */     }
/* line 179 */ 
/* line 180 */ 
/* line 181 */     private static long gcd(long l, long l1) {
/* line 182 NOT_COVERED */         if (l > l1) return gcd(l1, l);
/* line 183 NOT_COVERED */         if (l == 0) return l1;
/* line 184 NOT_COVERED */         return gcd(l1 % l, l);
/* line 185 */     }
/* line 186 */ 
/* line 187 */     private static long pow(long a, long b, long m) {
/* line 188 NOT_COVERED */         if (b == 0) return 1;
/* line 189 NOT_COVERED */         if (b == 1) return a;
/* line 190 NOT_COVERED */         long pp = pow(a, b / 2, m);
/* line 191 NOT_COVERED */         pp *= pp;
/* line 192 NOT_COVERED */         pp %= m;
/* line 193 NOT_COVERED */         return (pp * (b % 2 == 0 ? 1 : a)) % m;
/* line 194 */     }
/* line 195 */ 
/* line 196 */ 
/* line 197 */     static class MyScanner {
/* line 198 */         BufferedReader br;
/* line 199 */         StringTokenizer st;
/* line 200 */ 
/* line 201 COVERED, hit count: 1 */         MyScanner(BufferedReader br) {
/* line 202 COVERED, hit count: 1 */             this.br = br;
/* line 203 COVERED, hit count: 1 */         }
/* line 204 */ 
/* line 205 */         public MyScanner(InputStream in) {
/* line 206 COVERED, hit count: 1 */             this(new BufferedReader(new InputStreamReader(in)));
/* line 207 COVERED, hit count: 1 */         }
/* line 208 */ 
/* line 209 */         void findToken() {
/* line 210 PARTIALLY_COVERED, hit count: 38 */             while (st == null || !st.hasMoreTokens()) {
/* line 211 */                 try {
/* line 212 COVERED, hit count: 8 */                     st = new StringTokenizer(br.readLine());
/* line 213 NOT_COVERED */                 } catch (IOException e) {
/* line 214 NOT_COVERED */                     throw new RuntimeException(e);
/* line 215 COVERED, hit count: 8 */                 }
/* line 216 */             }
/* line 217 COVERED, hit count: 30 */         }
/* line 218 */ 
/* line 219 */         String next() {
/* line 220 COVERED, hit count: 30 */             findToken();
/* line 221 COVERED, hit count: 30 */             return st.nextToken();
/* line 222 */         }
/* line 223 */ 
/* line 224 */         Integer[] nab(int n) {
/* line 225 NOT_COVERED */             Integer[] k = new Integer[n];
/* line 226 NOT_COVERED */             for (int i = 0; i < n; i++) {
/* line 227 NOT_COVERED */                 k[i] = sc.fi();
/* line 228 */             }
/* line 229 NOT_COVERED */             return k;
/* line 230 */         }
/* line 231 */ 
/* line 232 */         int[] na(int n) {
/* line 233 NOT_COVERED */             int[] k = new int[n];
/* line 234 NOT_COVERED */             for (int i = 0; i < n; i++) {
/* line 235 NOT_COVERED */                 k[i] = sc.fi();
/* line 236 */             }
/* line 237 NOT_COVERED */             return k;
/* line 238 */         }
/* line 239 */ 
/* line 240 */         long[] nl(int n) {
/* line 241 NOT_COVERED */             long[] k = new long[n];
/* line 242 NOT_COVERED */             for (int i = 0; i < n; i++) {
/* line 243 NOT_COVERED */                 k[i] = sc.nextLong();
/* line 244 */             }
/* line 245 NOT_COVERED */             return k;
/* line 246 */         }
/* line 247 */ 
/* line 248 */         int nextInt() {
/* line 249 COVERED, hit count: 30 */             return Integer.parseInt(next());
/* line 250 */         }
/* line 251 */ 
/* line 252 */         int fi() {
/* line 253 NOT_COVERED */             String t = next();
/* line 254 NOT_COVERED */             int cur = 0;
/* line 255 NOT_COVERED */             boolean n = t.charAt(0) == '-';
/* line 256 NOT_COVERED */             for (int a = n ? 1 : 0; a < t.length(); a++) {
/* line 257 NOT_COVERED */                 cur = cur * 10 + t.charAt(a) - '0';
/* line 258 */             }
/* line 259 NOT_COVERED */             return n ? -cur : cur;
/* line 260 */         }
/* line 261 */ 
/* line 262 */         long nextLong() {
/* line 263 NOT_COVERED */             return Long.parseLong(next());
/* line 264 */         }
/* line 265 */ 
/* line 266 */         double nextDouble() {
/* line 267 NOT_COVERED */             return Double.parseDouble(next());
/* line 268 */         }
/* line 269 */     }
/* line 270 */ 
/* line 271 */ 
/* line 272 */ }