/* line 1 */ 
/* line 2 */ // Problem : F. Scalar Queries
/* line 3 */ // Contest : Codeforces - Educational Codeforces Round 65 (Rated for Div. 2)
/* line 4 */ // URL : https://codeforces.com/contest/1167/problem/F
/* line 5 */ // Memory Limit : 256 MB
/* line 6 */ // Time Limit : 2000 ms
/* line 7 */ // Powered by CP Editor (https://github.com/cpeditor/cpeditor)
/* line 8 */ 
/* line 9 */ import java.io.*;
/* line 10 */ import java.util.*;
/* line 11 */ import java.util.stream.*;
/* line 12 */ 
/* line 13 COVERED, hit count: 1 */ public class a implements Runnable{
/* line 14 */ 	
/* line 15 */     public static void main(String[] args) {
/* line 16 COVERED, hit count: 1 */         new Thread(null, new a(), "process", 1<<26).start();
/* line 17 COVERED, hit count: 1 */     }
/* line 18 */ 	public void run() {
/* line 19 COVERED, hit count: 1 */ 		FastReader scan = new FastReader();
/* line 20 COVERED, hit count: 1 */         PrintWriter out = new PrintWriter(new OutputStreamWriter(System.out));
/* line 21 */ 		//PrintWriter out = new PrintWriter("file.out");
/* line 22 COVERED, hit count: 1 */ 		Task solver = new Task();
/* line 23 */ 		//int t = scan.nextInt();
/* line 24 COVERED, hit count: 1 */ 		int t = 1;
/* line 25 PARTIALLY_COVERED, hit count: 1 */ 		for(int i = 1; i <= t; i++) solver.solve(i, scan, out);
/* line 26 COVERED, hit count: 1 */ 		out.close();
/* line 27 COVERED, hit count: 1 */ 	}
/* line 28 */ 
/* line 29 COVERED, hit count: 1 */ 	static class Task {
/* line 30 */ 		static final int inf = Integer.MAX_VALUE;
/* line 31 */ 
/* line 32 */ 		public void solve(int testNumber, FastReader sc, PrintWriter pw) {
/* line 33 */ 			//CHECK FOR QUICKSORT TLE
/* line 34 */ 			//***********************//
/* line 35 */ 			//CHECK FOR INT OVERFLOW
/* line 36 */ 			//***********************//
/* line 37 COVERED, hit count: 1 */ 			int n = sc.nextInt();
/* line 38 COVERED, hit count: 1 */ 			tup[] arr = new tup[n];
/* line 39 PARTIALLY_COVERED, hit count: 3 */ 			for(int i = 0; i < n; i++) {
/* line 40 COVERED, hit count: 2 */ 				arr[i] = new tup(sc.nextInt(), i);
/* line 41 */ 			}
/* line 42 COVERED, hit count: 1 */ 			Arrays.sort(arr);
/* line 43 COVERED, hit count: 1 */ 			bit left = new bit(n);
/* line 44 COVERED, hit count: 1 */ 			bit righ = new bit(n);
/* line 45 COVERED, hit count: 1 */ 			long sum = 0;
/* line 46 PARTIALLY_COVERED, hit count: 3 */ 			for(int i = 0; i < n; i++) {
/* line 47 COVERED, hit count: 2 */ 				sum += 1l * (arr[i].b + 1) * (n - arr[i].b) % 1000000007 * arr[i].a;
/* line 48 COVERED, hit count: 2 */ 				sum %= 1000000007;
/* line 49 COVERED, hit count: 2 */ 				sum += 1l * left.sum(arr[i].b - 1) % 1000000007 * (n - arr[i].b) % 1000000007 * arr[i].a;
/* line 50 COVERED, hit count: 2 */ 				sum %= 1000000007;
/* line 51 COVERED, hit count: 2 */ 				sum += 1l * righ.sum(n - 1, arr[i].b + 1) % 1000000007 * (arr[i].b + 1) % 1000000007 * arr[i].a;
/* line 52 COVERED, hit count: 2 */ 				sum %= 1000000007;
/* line 53 COVERED, hit count: 2 */ 				left.add(arr[i].b, arr[i].b + 1);
/* line 54 COVERED, hit count: 2 */ 				righ.add(arr[i].b, n - arr[i].b);
/* line 55 */ 			}
/* line 56 COVERED, hit count: 1 */ 			pw.println(sum);
/* line 57 COVERED, hit count: 1 */ 		}
/* line 58 */ 		static class bit { 
/* line 59 */ 			int n;
/* line 60 */ 			long[] bit;
/* line 61 COVERED, hit count: 2 */ 			public bit(int n) {
/* line 62 COVERED, hit count: 2 */ 				this.n=n;
/* line 63 COVERED, hit count: 2 */ 				bit=new long[n+1];
/* line 64 COVERED, hit count: 2 */ 			}
/* line 65 */ 			void add(int ind, long c) {
/* line 66 PARTIALLY_COVERED, hit count: 16 */ 				for(; ind<n;ind|=(ind+1)) {
/* line 67 COVERED, hit count: 6 */ 					bit[ind]+=c;
/* line 68 */ 				}
/* line 69 COVERED, hit count: 4 */ 			}
/* line 70 */ 			long sum(int r) {
/* line 71 COVERED, hit count: 6 */ 				long out =0;
/* line 72 PARTIALLY_COVERED, hit count: 16 */ 				for(;r>=0;r=(r&(r+1))-1) {
/* line 73 COVERED, hit count: 5 */ 					out+=bit[r];
/* line 74 */ 				}
/* line 75 COVERED, hit count: 6 */ 				return out;
/* line 76 */ 			}
/* line 77 */ 			long sum(int r, int l) {
/* line 78 COVERED, hit count: 2 */ 				return sum(r)-sum(l-1);
/* line 79 */ 			}
/* line 80 */ 		}
/* line 81 */ 	}
/* line 82 */ 	static long binpow(long a, long b, long m) {
/* line 83 NOT_COVERED */ 		a %= m;
/* line 84 NOT_COVERED */ 		long res = 1;
/* line 85 NOT_COVERED */ 		while (b > 0) {
/* line 86 NOT_COVERED */ 			if ((b & 1) == 1)
/* line 87 NOT_COVERED */ 				res = res * a % m;
/* line 88 NOT_COVERED */ 			a = a * a % m;
/* line 89 NOT_COVERED */ 			b >>= 1;
/* line 90 */ 		}
/* line 91 NOT_COVERED */ 		return res;
/* line 92 */ 	}
/* line 93 */ 	static void sort(int[] x){
/* line 94 NOT_COVERED */ 		shuffle(x);
/* line 95 NOT_COVERED */ 		Arrays.sort(x);
/* line 96 NOT_COVERED */ 	}
/* line 97 */ 	static void sort(long[] x){
/* line 98 NOT_COVERED */ 		shuffle(x);
/* line 99 NOT_COVERED */ 		Arrays.sort(x);
/* line 100 NOT_COVERED */ 	}
/* line 101 */ 	static class tup implements Comparable<tup>{
/* line 102 */ 		int a, b;
/* line 103 COVERED, hit count: 2 */ 		tup(int a,int b){
/* line 104 COVERED, hit count: 2 */ 			this.a=a;
/* line 105 COVERED, hit count: 2 */ 			this.b=b;
/* line 106 COVERED, hit count: 2 */ 		}
/* line 107 */ 		@Override
/* line 108 */ 		public int compareTo(tup o){
/* line 109 COVERED, hit count: 1 */ 			return Integer.compare(a,o.a);
/* line 110 */ 		}
/* line 111 */ 	}
/* line 112 */ 	static void shuffle(int[] a) {
/* line 113 NOT_COVERED */ 		Random get = new Random();
/* line 114 NOT_COVERED */ 		for (int i = 0; i < a.length; i++) {
/* line 115 NOT_COVERED */ 			int r = get.nextInt(i + 1);
/* line 116 NOT_COVERED */ 			int temp = a[i];
/* line 117 NOT_COVERED */ 			a[i] = a[r];
/* line 118 NOT_COVERED */ 			a[r] = temp;
/* line 119 */ 		}
/* line 120 NOT_COVERED */ 	}
/* line 121 */ 
/* line 122 */ 	static void shuffle(long[] a) {
/* line 123 NOT_COVERED */ 		Random get = new Random();
/* line 124 NOT_COVERED */ 		for (int i = 0; i < a.length; i++) {
/* line 125 NOT_COVERED */ 			int r = get.nextInt(i + 1);
/* line 126 NOT_COVERED */ 			long temp = a[i];
/* line 127 NOT_COVERED */ 			a[i] = a[r];
/* line 128 NOT_COVERED */ 			a[r] = temp;
/* line 129 */ 		}
/* line 130 NOT_COVERED */ 	}
/* line 131 */ 
/* line 132 */ 	static class FastReader {
/* line 133 */ 		BufferedReader br;
/* line 134 */ 		StringTokenizer st;
/* line 135 */ 
/* line 136 COVERED, hit count: 1 */ 		public FastReader() {
/* line 137 COVERED, hit count: 1 */ 			br = new BufferedReader(new InputStreamReader(System.in));
/* line 138 COVERED, hit count: 1 */ 		}
/* line 139 */ 
/* line 140 NOT_COVERED */ 		public FastReader(String s) throws FileNotFoundException {
/* line 141 NOT_COVERED */ 			br = new BufferedReader(new FileReader(new File(s)));
/* line 142 NOT_COVERED */ 		}
/* line 143 */ 
/* line 144 */ 		String next() {
/* line 145 PARTIALLY_COVERED, hit count: 5 */ 			while (st == null || !st.hasMoreElements()) {
/* line 146 */ 				try {
/* line 147 COVERED, hit count: 2 */ 					st = new StringTokenizer(br.readLine());
/* line 148 NOT_COVERED */ 				} catch (IOException e) {
/* line 149 NOT_COVERED */ 					e.printStackTrace();
/* line 150 COVERED, hit count: 2 */ 				}
/* line 151 */ 			}
/* line 152 COVERED, hit count: 3 */ 			return st.nextToken();
/* line 153 */ 		}
/* line 154 */ 
/* line 155 */ 		int nextInt() {
/* line 156 COVERED, hit count: 3 */ 			return Integer.parseInt(next());
/* line 157 */ 		}
/* line 158 */ 
/* line 159 */ 		long nextLong() {
/* line 160 NOT_COVERED */ 			return Long.parseLong(next());
/* line 161 */ 		}
/* line 162 */ 
/* line 163 */ 		double nextDouble() {
/* line 164 NOT_COVERED */ 			return Double.parseDouble(next());
/* line 165 */ 		}
/* line 166 */ 
/* line 167 */ 		String nextLine() {
/* line 168 NOT_COVERED */ 			String str = "";
/* line 169 */ 			try {
/* line 170 NOT_COVERED */ 				str = br.readLine();
/* line 171 NOT_COVERED */ 			} catch (IOException e) {
/* line 172 NOT_COVERED */ 				e.printStackTrace();
/* line 173 NOT_COVERED */ 			}
/* line 174 NOT_COVERED */ 			return str;
/* line 175 */ 		}
/* line 176 */ 	}
/* line 177 */ 
/* line 178 */ }