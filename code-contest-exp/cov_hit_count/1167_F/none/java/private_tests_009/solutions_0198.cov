/* line 1 */ import java.awt.*;
/* line 2 */ import java.io.BufferedInputStream;
/* line 3 */ import java.io.BufferedOutputStream;
/* line 4 */ import java.io.PrintStream;
/* line 5 */ import java.util.*;
/* line 6 */ 
/* line 7 NOT_COVERED */ public class CF_1167F {
/* line 8 COVERED, hit count: 1 */     static long MOD = (long) 1e9 + 7;
/* line 9 */ 
/* line 10 */     public static void main(String[] args) {
/* line 11 COVERED, hit count: 1 */         Scanner in = new Scanner(new BufferedInputStream(System.in));
/* line 12 COVERED, hit count: 1 */         PrintStream out = new PrintStream(new BufferedOutputStream(System.out));
/* line 13 */ 
/* line 14 COVERED, hit count: 1 */         int n = in.nextInt();
/* line 15 COVERED, hit count: 1 */         int[] arr = new int[n];
/* line 16 */ 
/* line 17 PARTIALLY_COVERED, hit count: 1 */         for (int i = 0; i < n; i++) arr[i] = in.nextInt();
/* line 18 */ 
/* line 19 COVERED, hit count: 1 */         long ret = 0;
/* line 20 PARTIALLY_COVERED, hit count: 2 */         for (int i = 0; i < n; i++) {
/* line 21 COVERED, hit count: 1 */             ret += (1L * arr[i] * (n - i)) % MOD * (i + 1);
/* line 22 COVERED, hit count: 1 */             ret %= MOD;
/* line 23 */         }
/* line 24 */ 
/* line 25 */ 
/* line 26 COVERED, hit count: 1 */         int[] tmp = arr.clone();
/* line 27 COVERED, hit count: 1 */         Arrays.sort(tmp);
/* line 28 */ 
/* line 29 COVERED, hit count: 1 */         HashMap<Integer, Integer> ccmp = new HashMap<>();
/* line 30 PARTIALLY_COVERED, hit count: 1 */         for(int i = 0; i < n; i++)ccmp.put(tmp[i], i);
/* line 31 */ 
/* line 32 COVERED, hit count: 1 */         BIT lbit = new BIT(n);
/* line 33 COVERED, hit count: 1 */         BIT rbit = new BIT(n);
/* line 34 */ 
/* line 35 PARTIALLY_COVERED, hit count: 2 */         for(int i = 0; i < n ;i++){
/* line 36 COVERED, hit count: 1 */             int curr = arr[i];
/* line 37 */ 
/* line 38 COVERED, hit count: 1 */             ret += ((long) curr * (n - i)) % MOD * lbit.query(ccmp.get(curr));
/* line 39 COVERED, hit count: 1 */             ret %= MOD;
/* line 40 */ 
/* line 41 COVERED, hit count: 1 */             lbit.update(ccmp.get(curr), i + 1);
/* line 42 */         }
/* line 43 */ 
/* line 44 PARTIALLY_COVERED, hit count: 2 */         for(int i = n - 1; i >= 0; i--){
/* line 45 COVERED, hit count: 1 */             int curr = arr[i];
/* line 46 */ 
/* line 47 COVERED, hit count: 1 */             ret += ((long) curr * (i + 1)) % MOD * rbit.query(ccmp.get(curr));
/* line 48 COVERED, hit count: 1 */             ret %= MOD;
/* line 49 */ 
/* line 50 COVERED, hit count: 1 */             rbit.update(ccmp.get(curr), n - i);
/* line 51 */         }
/* line 52 */ 
/* line 53 COVERED, hit count: 1 */         out.println(ret);
/* line 54 */ 
/* line 55 COVERED, hit count: 1 */         out.close();
/* line 56 COVERED, hit count: 1 */         in.close();
/* line 57 COVERED, hit count: 1 */     }
/* line 58 */ 
/* line 59 */     static class BIT {
/* line 60 */         long[] mem;
/* line 61 */ 
/* line 62 COVERED, hit count: 2 */         BIT(int n) {
/* line 63 COVERED, hit count: 2 */             mem = new long[n + 1];
/* line 64 COVERED, hit count: 2 */         }
/* line 65 */ 
/* line 66 */         public void update(int n, int k) {
/* line 67 PARTIALLY_COVERED, hit count: 4 */             for (int i = n + 1; i < mem.length; i += -i & i) {
/* line 68 COVERED, hit count: 2 */                 mem[i] += k;
/* line 69 COVERED, hit count: 2 */                 mem[i] %= MOD;
/* line 70 */             }
/* line 71 COVERED, hit count: 2 */         }
/* line 72 */ 
/* line 73 */         long query(int n) {
/* line 74 COVERED, hit count: 2 */             long ret = 0;
/* line 75 PARTIALLY_COVERED, hit count: 4 */             for (int i = n + 1; i > 0; i -= -i & i) {
/* line 76 COVERED, hit count: 2 */                 ret += mem[i];
/* line 77 COVERED, hit count: 2 */                 ret %= MOD;
/* line 78 */             }
/* line 79 */ 
/* line 80 COVERED, hit count: 2 */             return ret;
/* line 81 */         }
/* line 82 */     }
/* line 83 */ }